#!/usr/bin/python
from argparse import *
import os
import glob
import platform
from datetime import date

today = date.today()

print("Today's date:", today)

parser = ArgumentParser()

parser.add_argument('--min_num_cells', type=int, help='Smallest problem domain size to set up [64].'  ,default='64')
parser.add_argument('--max_num_cells', type=int, help='Largest  problem domain size to set up [64].'  ,default='64')
parser.add_argument('--input_template_dir', type=str, help='Directory of input file templates [../_input_templates].' ,default="../_input_templates")
parser.add_argument('--batch', type=str, help='batch file template'   ,default="_batch_templates/serial.batch")
parser.add_argument('--prefix', type=str, help='name of test["_prch_compare"]',default="prch_compare")

args = parser.parse_args()
print(args)
homestr = os.getcwd();
print ("homedir = " + homestr)
neartopstr = homestr + "/_" +args.prefix
strtoday =str(today.month) + "_" + str(today.day) + "_" + str(today.year)
topstr = neartopstr + "_" + strtoday
print ("topstr = " + topstr)
if not os.path.exists(topstr):
    printstr = "making directory " + topstr
    print (printstr)
    os.mkdir(topstr)
i_min_case = 0
i_max_case = 1
print ("changing directory to " + topstr)
os.chdir(topstr);
operators=['helmholtz'
           'conductivity'
           'viscous_tensor'
           'resistivity']

# loop through cases to run
i_case = i_min_case
while i_case <= i_max_case:
    i_dim = 2
    # loop through dimensions
    while i_dim <= 3:
        #loop through opt     
        i_opt = 0
        while i_opt <= 1:
            #I hesitate to use = when directories will be made
            #This also allows the directory name to be less shouty
            opt_status = "opt_false"
            opt_gmake  = "OPT=FALSE"
            deb_status = "debug_true"
            deb_gmake  = "DEBUG=TRUE"
            
            if(i_opt == 1):
                opt_status = "opt_high"
                opt_gmake  = "OPT=HIGH"
                deb_status = "debug_false"
                deb_gmake  = "DEBUG=FALSE"

            i_ncells = args.min_num_cells
            while i_ncells <=  args.max_num_cells:
                str_config = "_case_" + str(i_case) + "_" + str(i_dim) + "_" + opt_status + "_" + deb_status + "_nx_" + str(i_ncells)
                print (str_config)
                config_directory = str_config
                if not os.path.exists(config_directory):
                    printstr = "making directory " + config_directory
                    print (printstr)
                    os.mkdir(config_directory)

                i_ncells = 2*i_ncells
                # end loop over values of nx
                
            i_opt = i_opt + 1
            # end loop over values of i_opt


        i_dim = i_dim + 1
        # end loop over values of i_dim

    i_case = i_case + 1
    # end loop over values of i_case
    
